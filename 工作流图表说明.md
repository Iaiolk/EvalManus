# Manus工作流系统架构与流程图说明

## 概览

本项目创建了基于Manus风格的智能工作流系统，专门用于Session行为评估。系统采用Agent架构，支持条件执行、并行处理、错误重试等企业级特性。

## 图表文件

### 1. 系统架构示意图 (`Manus_工作流系统架构示意图.drawio`)

**用途**: 展示整个Manus工作流系统的架构层次和组件关系

**主要内容**:

- **输入层**: Session数据输入
- **工作流定义层**: 节点依赖关系、执行条件、并行配置
- **执行引擎层**: ManusWorkflowExecutor核心功能
- **智能Agent层**: 7个专业化Agent组件
- **输出层**: 评估结果和执行日志

**系统特性**:

- ✓ 智能条件执行：根据上下文动态决策
- ✓ 并行处理能力：多Agent同时执行
- ✓ 错误恢复机制：自动重试和容错
- ✓ 状态管理：实时跟踪执行状态
- ✓ 拓扑排序：智能依赖解析
- ✓ 超时控制：防止任务卡死
- ✓ 结果追溯：完整的执行链路

### 2. Session评估详细流程图 (`Session评估工作流详细流程图.drawio`)

**用途**: 详细展示Session评估工作流的执行流程和数据流向

**主要阶段**:

1. **数据预处理阶段** - DataPreprocessingAgent
2. **意图识别阶段** - IntentRecognitionAgent
3. **LLM评估阶段** - LLMEvaluationAgent
4. **条件判断** - 是否需要溯源验证
5. **溯源验证分支** (可选):
   - QueryAssessmentAgent - 溯源需求评估
   - SearchAPIAgent - 外部搜索
   - AccuracyTracingAgent - 准确性溯源
6. **最终评分阶段** - FinalScoringAgent

**执行特性**:

- **智能条件分支**: 根据LLM评估结果决定是否进行溯源
- **并行处理能力**: 多个阶段可以并行执行以提高效率
- **错误重试机制**: 每个Agent都支持失败重试
- **超时控制**: 防止单个Agent执行时间过长
- **状态跟踪**: 实时监控每个节点的执行状态

## 数据流转规则

- 每个Agent接收上一阶段的输出作为输入
- 工作流上下文在所有Agent间共享
- 条件节点根据上下文数据进行决策
- 最终结果包含所有阶段的执行信息

## 使用方式

1. **查看系统架构**: 使用draw.io打开`Manus_工作流系统架构示意图.drawio`
2. **了解执行流程**: 使用draw.io打开`Session评估工作流详细流程图.drawio`
3. **运行示例**: 执行`run_session_workflow.py`脚本

## 技术特点

- **模块化设计**: 每个Agent职责明确，易于扩展
- **智能化调度**: 支持复杂的条件逻辑和并行执行
- **容错能力强**: 多层次的错误处理和重试机制
- **可视化监控**: 完整的状态跟踪和日志记录
- **企业级特性**: 超时控制、资源管理、性能优化

这套工作流系统为Session评估提供了强大而灵活的解决方案，支持复杂业务逻辑的自动化执行。
