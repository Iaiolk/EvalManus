<mxfile host="app.diagrams.net" modified="2024-06-04T00:00:00.000Z" agent="5.0" etag="def456" version="21.1.2" type="device">
  <diagram name="Session评估流程详细图" id="session-eval-detailed-flow">
    <mxGraphModel dx="1422" dy="795" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- 标题 -->
        <mxCell id="title" value="Session评估工作流详细流程图" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1565C0;" vertex="1" parent="1">
          <mxGeometry x="350" y="20" width="400" height="40" as="geometry"/>
        </mxCell>

        <!-- 开始节点 -->
        <mxCell id="start" value="开始" style="ellipse;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#388E3C;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="80" width="80" height="40" as="geometry"/>
        </mxCell>

        <!-- 数据预处理阶段 -->
        <mxCell id="preprocessing-phase" value="阶段1：数据预处理" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="80" width="120" height="40" as="geometry"/>
        </mxCell>

        <mxCell id="data-preprocessing-detail" value="DataPreprocessingAgent&#xa;• 清理对话数据&#xa;• 格式标准化&#xa;• 提取关键信息&#xa;• 数据验证" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FE;strokeColor=#0288D1;" vertex="1" parent="1">
          <mxGeometry x="200" y="140" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- 意图识别阶段 -->
        <mxCell id="intent-phase" value="阶段2：意图识别" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="360" y="80" width="120" height="40" as="geometry"/>
        </mxCell>

        <mxCell id="intent-recognition-detail" value="IntentRecognitionAgent&#xa;• 分析用户意图&#xa;• 识别查询类型&#xa;• 提取关键实体&#xa;• 意图分类" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8BBD9;strokeColor=#AD1457;" vertex="1" parent="1">
          <mxGeometry x="360" y="140" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- LLM评估阶段 -->
        <mxCell id="llm-phase" value="阶段3：LLM评估" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#F57C00;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="80" width="120" height="40" as="geometry"/>
        </mxCell>

        <mxCell id="llm-evaluation-detail" value="LLMEvaluationAgent&#xa;• 评估回答质量&#xa;• 检查逻辑一致性&#xa;• 分析语言流畅度&#xa;• 相关性评分" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFECB3;strokeColor=#FF8F00;" vertex="1" parent="1">
          <mxGeometry x="520" y="140" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- 条件判断 -->
        <mxCell id="need-tracing-decision" value="是否需要&#xa;溯源验证？" style="rhombus;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#D32F2F;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="680" y="160" width="100" height="60" as="geometry"/>
        </mxCell>

        <!-- 溯源分支 -->
        <mxCell id="tracing-branch" value="溯源验证分支" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#388E3C;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="300" width="500" height="30" as="geometry"/>
        </mxCell>

        <!-- 溯源需求评估 -->
        <mxCell id="query-assessment-detail" value="QueryAssessmentAgent&#xa;• 分析溯源需求&#xa;• 确定搜索策略&#xa;• 生成查询关键词&#xa;• 评估搜索复杂度" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#388E3C;" vertex="1" parent="1">
          <mxGeometry x="200" y="350" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- 外部搜索 -->
        <mxCell id="search-api-detail" value="SearchAPIAgent&#xa;• 调用外部API&#xa;• 多源信息检索&#xa;• 结果聚合处理&#xa;• 相关性筛选" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#388E3C;" vertex="1" parent="1">
          <mxGeometry x="360" y="350" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- 准确性溯源 -->
        <mxCell id="accuracy-tracing-detail" value="AccuracyTracingAgent&#xa;• 对比验证信息&#xa;• 计算准确性分数&#xa;• 识别事实错误&#xa;• 生成溯源报告" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#388E3C;" vertex="1" parent="1">
          <mxGeometry x="520" y="350" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- 最终评分 -->
        <mxCell id="final-scoring-detail" value="FinalScoringAgent&#xa;• 综合所有评分&#xa;• 加权计算总分&#xa;• 生成详细报告&#xa;• 提供改进建议" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#C2185B;" vertex="1" parent="1">
          <mxGeometry x="680" y="350" width="120" height="100" as="geometry"/>
        </mxCell>

        <!-- 结束节点 -->
        <mxCell id="end" value="结束&#xa;输出评估结果" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="840" y="350" width="90" height="60" as="geometry"/>
        </mxCell>

        <!-- 主流程箭头 -->
        <mxCell id="flow-start-to-preprocessing" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976D2;" edge="1" parent="1" source="start" target="preprocessing-phase">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="flow-preprocessing-to-intent" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976D2;" edge="1" parent="1" source="preprocessing-phase" target="intent-phase">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="flow-intent-to-llm" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976D2;" edge="1" parent="1" source="intent-phase" target="llm-phase">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="flow-llm-to-decision" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976D2;" edge="1" parent="1" source="llm-phase" target="need-tracing-decision">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- 溯源分支箭头 -->
        <mxCell id="flow-decision-to-query" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#388E3C;" edge="1" parent="1" source="need-tracing-decision" target="query-assessment-detail">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="730" y="260" as="sourcePoint"/>
            <mxPoint x="260" y="330" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <mxCell id="flow-query-to-search" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#388E3C;" edge="1" parent="1" source="query-assessment-detail" target="search-api-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="flow-search-to-accuracy" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#388E3C;" edge="1" parent="1" source="search-api-detail" target="accuracy-tracing-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="flow-accuracy-to-final" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#388E3C;" edge="1" parent="1" source="accuracy-tracing-detail" target="final-scoring-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- 直接到最终评分的箭头 -->
        <mxCell id="flow-decision-to-final-direct" value="否" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#D32F2F;dashed=1;" edge="1" parent="1" source="need-tracing-decision" target="final-scoring-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- 最终结束箭头 -->
        <mxCell id="flow-final-to-end" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#C2185B;" edge="1" parent="1" source="final-scoring-detail" target="end">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- 详细流程从详细节点连接 -->
        <mxCell id="detail-flow1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;dashed=1;" edge="1" parent="1" source="preprocessing-phase" target="data-preprocessing-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="detail-flow2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;dashed=1;" edge="1" parent="1" source="intent-phase" target="intent-recognition-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="detail-flow3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#666666;dashed=1;" edge="1" parent="1" source="llm-phase" target="llm-evaluation-detail">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- 并行执行说明 -->
        <mxCell id="parallel-note" value="并行执行区域&#xa;当条件满足时，多个Agent&#xa;可以同时执行以提高效率" style="text;html=1;strokeColor=#FF9800;fillColor=#FFF3E0;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="340" y="480" width="160" height="60" as="geometry"/>
        </mxCell>

        <!-- 执行特性说明 -->
        <mxCell id="execution-features" value="执行特性说明：&#xa;• 智能条件分支：根据LLM评估结果决定是否进行溯源&#xa;• 并行处理能力：数据预处理、意图识别、LLM评估可并行&#xa;• 错误重试机制：每个Agent都支持失败重试&#xa;• 超时控制：防止单个Agent执行时间过长&#xa;• 状态跟踪：实时监控每个节点的执行状态" style="text;html=1;strokeColor=#81C784;fillColor=#E8F5E8;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=11;spacing=5;" vertex="1" parent="1">
          <mxGeometry x="80" y="580" width="400" height="120" as="geometry"/>
        </mxCell>

        <!-- 数据流转说明 -->
        <mxCell id="data-flow-note" value="数据流转规则：&#xa;• 每个Agent接收上一阶段的输出作为输入&#xa;• 工作流上下文在所有Agent间共享&#xa;• 条件节点根据上下文数据进行决策&#xa;• 最终结果包含所有阶段的执行信息" style="text;html=1;strokeColor=#FF9800;fillColor=#FFF3E0;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=11;spacing=5;" vertex="1" parent="1">
          <mxGeometry x="520" y="580" width="300" height="120" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
